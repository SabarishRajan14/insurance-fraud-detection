<!DOCTYPE html>
<html>
<head>
    <title>Insurance Fraud Detection</title>
</head>
<body>
    <h1>Predict Insurance Fraud</h1>
    <form id="claim-form">
        <label for="policy_deductable">Policy Deductable:</label><br>
        <input type="number" id="policy_deductable" name="policy_deductable" required><br><br>
        
        <label for="policy_annual_premium">Annual Premium:</label><br>
        <input type="number" step="0.01" id="policy_annual_premium" name="policy_annual_premium" required><br><br>

        <label for="umbrella_limit">Umbrella Limit:</label><br>
        <input type="number" id="umbrella_limit" name="umbrella_limit" required><br><br>

        <label for="policy_csl">Policy CSL:</label><br>
        <input type="text" id="policy_csl" name="policy_csl" required><br><br>

        <button type="submit">Predict Fraud</button>
    </form>

    <div id="result"></div>

    <script>
        document.getElementById('claim-form').addEventListener('submit', async function(event) {
            event.preventDefault();

            const form = event.target;
            const formData = new FormData(form);
            const jsonData = {};
            formData.forEach((value, key) => {
                // Convert numbers to integers/floats as needed
                if (key === 'policy_deductable' || key === 'umbrella_limit' /* ... and all other int fields */) {
                    jsonData[key] = parseInt(value);
                } else if (key === 'policy_annual_premium' /* ... and all other float fields */) {
                    jsonData[key] = parseFloat(value);
                } else {
                    jsonData[key] = value;
                }
            });

            try {
                const response = await fetch('/predict_fraud', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(jsonData),
                });

                const result = await response.json();
                
                const resultDiv = document.getElementById('result');
                if (response.ok) {
                    resultDiv.innerHTML = `
                        <h3>Prediction Result:</h3>
                        <p>Fraud Probability: ${Math.round(result.fraud_probability * 100)}%</p>
                        <p>Risk Level: <strong>${result.risk_level}</strong></p>
                    `;
                } else {
                    resultDiv.innerHTML = `<p style="color:red;">Error: ${result.detail}</p>`;
                }
            } catch (error) {
                console.error('Error:', error);
                document.getElementById('result').innerHTML = `<p style="color:red;">An error occurred. Please try again.</p>`;
            }
        });
    </script>
</body>
</html>